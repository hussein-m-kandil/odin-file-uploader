<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('partials/meta', { title }) %>
  </head>
  <body>
    <%- include('partials/navbar') %>
    <div class="container mt-4 text-center">
      <header>
        <%- include('partials/alert') %>
        <h2 class="mb-4 fw-bold"><%= title %></h2>
      </header>
      <% const slug = url.split('/').at(-1).toLowerCase() %>
      <form
        method="post"
        enctype="<%= slug === 'upload' ? 'multipart/form-data' : 'application/x-www-form-urlencoded' %>"
      >
        <% if (slug === 'share') { %>
        <div class="mb-3 lead fw-bold">
          <!-- prettier-ignore -->
          <% const daysErr = locals.validationErrors?.days %>
          <script>
            function handleDaysNumberChange(input) {
              if (!input.value) input.value = 1;
              const span = document.getElementById('days-span');
              if (span) {
                span.textContent = Math.abs(input.value) === 1 ? 'Day' : 'Days';
              }
            }
          </script>
          <span>For</span>
          <input
            style="
              width: 4rem;
              appearance: none;
              border-radius: 0.5rem;
              -webkit-appearance: none;
              border: 1px solid var(--bs-primary-border-subtle);
              outline-color: var(--bs-primary-border-subtle);
              accent-color: var(--bs-primary-border-subtle);
            "
            class="text-center fw-bold<%= daysErr ? ' is-invalid' : '' %>"
            type="number"
            name="days"
            value="<%= locals.formData?.days || '1' %>"
            step="1"
            min="1"
            onchange="handleDaysNumberChange(this)"
            autofocus
          />
          <span
            id="days-span"
            class="d-inline-block text-start"
            style="min-width: 2.5rem"
          >
            <!-- prettier-ignore -->
            Day<%= locals.formData?.days && (formData.days == 1 ? '' : 's') || '' %>
          </span>
          <% if (daysErr) { %>
          <div class="invalid-feedback fw-normal"><%= daysErr.msg %></div>
          <% } %>
        </div>
        <% } else if (slug !== 'delete') { %>
        <div class="form-floating mb-3">
          <% const nameErr = locals.validationErrors?.name %>
          <!-- prettier-ignore -->
          <input
            type="text"
            class="fw-bold form-control<%- nameErr ? ' is-invalid' : '' %>"
            name="name"
            id="name"
            autocomplete="off"
            placeholder="Enter<%= slug === 'upload' ? ' Optional' : '' %> Name"
            value="<%= locals.formData?.name || '' %>"
            <%= slug !== 'upload' ? 'autofocus' : '' %>
          />
          <label for="name">
            Enter<%= slug === 'upload' ? ' Optional' : '' %> Name
          </label>
          <% if (nameErr) { %>
          <div class="invalid-feedback"><%= nameErr.msg %></div>
          <% } %>
        </div>
        <% if (slug === 'upload') { %>
        <div class="mb-3">
          <% const fileErr = locals.validationErrors?.file %>
          <!-- prettier-ignore -->
          <input
            type="file"
            name="file"
            class="fw-bold form-control form-control-lg<%- fileErr ? ' is-invalid' : '' %>"
            autofocus
          />
          <% if (fileErr) { %>
          <div class="invalid-feedback"><%= fileErr.msg %></div>
          <% } %>
        </div>
        <% } %>
        <!-- prettier-ignore -->
        <% } %>
        <a
          role="button"
          href="<%= parentId ? `${baseUrl}/${parentId}` : baseUrl %>"
          class="btn btn-lg btn-outline-secondary me-1"
        >
          Cancel
        </a>
        <button
          type="submit"
          class="btn btn-lg btn-outline-<%= slug === 'delete' ? 'danger' : 'primary' %> ms-1"
        >
          <%= (slug[0].toUpperCase() + slug.slice(1)) %>
        </button>
      </form>
    </div>
  </body>
</html>
